<?xml version="1.0"?>
<launch>

    <node pkg="carrobot" type="carrobot_node.py" name="carrobot">
      <param name="base_lidar_x" value="0.1"/>
      <param name="base_lidar_y" value="0.0"/>
      <param name="base_lidar_z" value="0.05"/>
      <param name="lidar_motor_pwm_duty_cycle" value="1.0"/>
    </node>

    <node pkg="xv_11_laser_driver" type="neato_laser_publisher" name="neato_laser">
        <param name="~port" value="/dev/ttyUSB0"/>
    </node>

    <arg name="dev" default="/dev/ttyS0"/>
    <arg name="baud" default="38400"/>
    <arg name="address" default="128"/>
    <arg name="max_speed" default="2.0"/>
    <arg name="ticks_per_meter" default="4342.2"/>
    <arg name="base_width" default="0.315"/>
    <arg name="run_diag" default="true"/>

    <node if="$(arg run_diag)" pkg="roboclaw_node" type="roboclaw_node.py" name="roboclaw_node">
        <param name="~dev" value="$(arg dev)"/>
        <param name="~baud" value="$(arg baud)"/>
        <param name="~address" value="$(arg address)"/>
        <param name="~max_speed" value="$(arg max_speed)"/>
        <param name="~ticks_per_meter" value="$(arg ticks_per_meter)"/>
        <param name="~base_width" value="$(arg base_width)"/>
    </node>

    <node pkg="diagnostic_aggregator" type="aggregator_node"
          name="diagnostic_aggregator">
        <rosparam command="load"
                  file="$(find roboclaw_node)/config/roboclaw_diag.yaml"/>
    </node>

    <launch>
    	<arg name="enable_raw" default="false"/>
      <arg name="camera_id" default="0"/>
      <arg name="camera_frame_id" default="raspicam"/>
      <arg name="camera_name" default="camerav1_1280x720"/>

      <node type="raspicam_node" pkg="raspicam_node" name="raspicam_node" output="screen">
      	<param name="camera_frame_id" value="$(arg camera_frame_id)"/>
      	<param name="enable_raw" value="$(arg enable_raw)"/>
        <param name="camera_id" value="$(arg camera_id)"/>

        <param name="camera_info_url" value="package://raspicam_node/camera_info/camerav1_1280x720.yaml"/>
        <param name="camera_name" value="$(arg camera_name)"/>
        <param name="width" value="1280"/>
        <param name="height" value="720"/>
        <!-- We are running at 90fps to reduce motion blur -->
        <param name="framerate" value="90"/>
      </node>

    </launch>
</launch>
